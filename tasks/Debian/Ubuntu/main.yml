---
# https://www.google.com/search?q=rustup+unattended+install
# https://github.com/rust-lang/rustup/issues/297

- name: Install dependencies
  apt:
    name: "{{ item }}"
    state: present
    update_cache: yes
  loop:
    - curl
    - gcc
    - g++
    - pkg-config
    - make
  become: true

- name: Download and run Rust installation script
  shell: curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y
  #curl https://sh.rustup.rs -sSf | sh -s -- -y
  creates: "{{ ansible_env.HOME }}/.cargo/bin/rustc"